<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.ssafy.enjoytrip.naver.model.mapper.NaverMapper">

	<resultMap type="userDto" id="user">
		<!-- UserDto -->
		<result column="user_id" property="userId" />
		<result column="user_password" property="userPassword" />
		<result column="user_name" property="userName" />
		<result column="email_id" property="emailId" />
		<result column="email_domain" property="emailDomain" />
		<result column="gender" property="gender" />
		<result column="birth_date" property="birthDate" />
		<result column="register_date" property="registerDate" />
		<result column="token" property="token" />
		<!-- NaverDto -->
		<result column="sns_id" property="snsId" />
		<result column="sns_type" property="snsType" />
		<result column="sns_name" property="snsName" />
		<result column="sns_profile" property="snsProfile" />
		<result column="sns_gender" property="snsGender" />
		<result column="sns_brith_date" property="snsBirthDate" />
		<result column="sns_birth_year" property="snsBirthYear" />
		<result column="sns_connect_date" property="snsConnectDate" />
		
	</resultMap>

	<!-- 네이버로 회원가입 -->
	<insert id="insertSnsUser" parameterType="NaverDto">
		INSERT INTO sns_info
		(id, sns_id, sns_type, sns_name, sns_profile, sns_gender,
		sns_birth_date, sns_birth_year, sns_connect_date)
		VALUES (#{id},
		#{snsId}, #{snsType}, #{snsName}, #{snsProfile},#{snsGender},
		#{snsBirthDate}, #{snsBirthYear} ,now() )
	</insert>

	<!-- 네이버 로그인 / 로그아웃 을 위한 회원 조회-->
	<select id="selectSnsUserBySnsId" resultMap="user">
		SELECT a.user_name,
		a.email_id, a.email_domain, a.create_date, a.modify_date,
		b.sns_id, b.sns_type, b.sns_name, b.sns_profile, b.sns_connect_date
		FROM user a, sns_info b
		WHERE a.user_id = b.id
		AND b.sns_id = #{snsId}
	</select>

</mapper>